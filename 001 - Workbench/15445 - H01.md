[Course Page](https://15445.courses.cs.cmu.edu/fall2020/homework1/)

Usage of the time can not be computed

Q1: already shown on page

Q2:
```sql
SELECT wn, wtn FROM(
        SELECT wt.id wtid, wt.name wtn, w.name wn, RANK() OVER(PARTITION BY w.type ORDER BY length(w.name) DESC) AS r FROM work w, work_type wt WHERE w.type = wt.id
	) WHERE r = 1 ORDER BY wtid ASC, wn ASC;
```

> A field of `SELECT` can not tolerate more than 1 column

Q3:
```sql
SELECT area.name, count() cnt FROM artist art, area WHERE art.begin_date_year < 1850 AND area.id = art.area GROUP BY area.id ORDER BY cnt DESC LIMIT 10;
```

Q4:

```sql
SELECT vaid.name, alia.artist FROM (
	SELECT id, name FROM artist WHERE area = (SELECT id FROM area WHERE name = 'United Kingdom') AND begin_date_year > 1950
	) vaid, artist_alias alia WHERE alia.artist IN(vaid.id) GROUP BY alia.artist ORDER BY count(alia.artist) DESC LIMIT 10;
```

Q5:
```sql
SELECT r.name FROM release r, artist_credit a, medium m, medium_format mf, release_info ri WHERE a.name = 'Coldplay' AND r.artist_credit = a.id AND m.release = r.id AND mf.id = m.format AND mf.name LIKE '%vinyl' AND ri.release=r.id GROUP BY r.name ORDER BY ri.date_year ASC, ri.date_month ASC, ri.date_day ASC;
```

Q6:
```sql
 SELECT cast(ri.date_year / 10 as text) || '0s', count() FROM release r, release_info ri WHERE ri.date_year >= 1900 AND ri.date_year is not null AND r.status = 1 AND r.id = ri.release GROUP BY ri.date_year / 10 ORDER BY ri.date_year DESC;
```

Q7:
```sql
WITH c AS (SELECT * FROM release r, release_info ri WHERE ((date_year = 2019 AND date_month >= 7) OR date_year = 2020 AND date_month <= 7) AND r.id = ri.release) SELECT cast(date_year as text) || '.' || COALESCE((SELECT '0' WHERE da
te_month < 10), '') || cast(date_month as text), ROUND(cast(count() as double) / (SELECT count() FROM c) * 100, 2) FROM
c GROUP BY date_year, date_month ORDER BY date_year ASC, date_month ASC;
```

Q8:
```sql
SELECT count() FROM (SELECT * FROM artist_credit_name acn WHERE acn.artist_credit IN(SELECT ac.id FROM artist_credit ac WHERE ac.id IN(SELECT acn.artist_credit FROM artist_credit_name acn, artist a WHERE a.name = "Ariana Grande" AND acn.artist = a.id)) GROUP BY acn.artist);
```

Q9:
> If you use the `date_year` flag from `release_info`, the result may turn out to be weird, for the area of a specific `release` may be varied. This flag has been  removed from answer cause it not meet the requirements of the question.

> It can articulate more clearly if you use the criteria of `ASCII` with `INNER JOIN`, but it shows no distinction if you use `FROM` and `WHERE` correctly to eliminate the duplicated parts. 

```sql
SELECT * FROM (	
	SELECT 
		RANK() OVER(ORDER BY c DESC, n1 ASC), 
		*
	FROM (
		SELECT
			a1.name n1,
			a2.name n2,
			count() c
		FROM
			artist_credit ac,
			release r,
			language l,
			artist_credit_name acn1,
			artist_credit_name acn2,
			artist_type at,
			artist a1,
			artist a2
		WHERE
			ac.artist_count > 1 
			AND l.name = 'English'
			AND acn1.name < acn2.name
			AND at.name = 'Person'
			AND a1.begin_date_year > 1960
			AND a2.begin_date_year > 1960
			AND r.artist_credit = ac.id
			AND acn1.artist_credit = acn2.artist_credit
			AND acn1.artist_credit = ac.id
			AND a1.id = acn1.artist
			AND a2.id = acn2.artist
			AND r.language = l.id
			AND at.id = a1.type
			AND at.id = a2.type
		GROUP BY a1.id, a2.id
	) AS res
) WHERE
	n1 = 'Dr. Dre'
	AND n2 = 'Eminem'
;
```

Q10:

```sql
WITH RECURSIVE
	res(row, name) AS (
		SELECT
			row_number() OVER(), aa.name
		FROM
			artist_alias aa,
			artist a
		WHERE
			aa.artist = a.id
			AND a.name = 'The Beatles'
	),
	conc(row, name) AS (
		SELECT * FROM res WHERE res.row = 1 /* ininialative statement for further recursion */
		UNION ALL
		SELECT res.row, c.name || ', ' || res.name FROM res JOIN conc c ON res.row = c.row + 1 /* each computition as the initialative statement for the next recursion */
	)
SELECT conc.name FROM conc ORDER BY conc.row DESC LIMIT 1;
```